#tag WindowBegin Window wndMain   BackColor       =   16777215   Backdrop        =   ""   BalloonHelp     =   ""   CloseButton     =   "True"   Composite       =   "False"   Frame           =   0   FullScreen      =   "False"   HasBackColor    =   "False"   Height          =   741   ImplicitInstance=   "True"   LiveResize      =   "True"   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   "False"   MaxWidth        =   770   MenuBar         =   341440760   MenuBarVisible  =   "True"   MinHeight       =   618   MinimizeButton  =   "True"   MinWidth        =   770   Placement       =   0   Resizeable      =   "True"   Title           =   "#App.kApplicationName"   Visible         =   "True"   Width           =   770   Begin TabPanel tpnlMain      AutoDeactivate  =   "True"      Bold            =   ""      Enabled         =   True      Facing          =   0      Height          =   633      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   "True"      LockLeft        =   "True"      LockRight       =   "True"      LockTop         =   "True"      Panels          =   ""      Scope           =   0      SmallTabs       =   ""      TabDefinition   =   "#kTabTitleCustomSceneryPackages\r#kTabTitlePlugins\r#kTabTitleAircraft\r#kTabTitleCSLs"      TabIndex        =   0      TabPanelIndex   =   0      TextFont        =   "System"      TextSize        =   0      Top             =   86      Underline       =   ""      Value           =   0      Visible         =   True      Width           =   730      BehaviorIndex   =   0      Begin PushButton btnAddScenery         AutoDeactivate  =   "True"         Bold            =   ""         Cancel          =   ""         Caption         =   "#kAdd"         Default         =   ""         Enabled         =   True         Height          =   27         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "tpnlMain"         Italic          =   ""         Left            =   40         LockBottom      =   "True"         LockLeft        =   ""         LockRight       =   "False"         LockTop         =   ""         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   1         TextFont        =   "System"         TextSize        =   10         Top             =   318         Underline       =   ""         Visible         =   True         Width           =   80         BehaviorIndex   =   1      End      Begin ListBox lstCustomSceneryPackages         AutoDeactivate  =   "True"         AutoHideScrollbars=   "False"         Bold            =   ""         ColumnCount     =   8         ColumnsResizable=   ""         ColumnWidths    =   "*, 30, 35, 35, 35, 35, 35, 60"         DataField       =   ""         DataSource      =   ""         DefaultRowHeight=   -1         Enabled         =   True         EnableDrag      =   ""         EnableDragReorder=   ""         GridLinesHorizontal=   0         GridLinesVertical=   0         HasHeading      =   "True"         HeadingIndex    =   -1         Height          =   182         HelpTag         =   ""         Hierarchical    =   ""         Index           =   -2147483648         InitialParent   =   "tpnlMain"         InitialValue    =   ""         Italic          =   ""         Left            =   40         LockBottom      =   "True"         LockLeft        =   "True"         LockRight       =   "True"         LockTop         =   "True"         RequiresSelection=   ""         Scope           =   0         ScrollbarHorizontal=   ""         ScrollBarVertical=   "True"         SelectionType   =   0         TabIndex        =   1         TabPanelIndex   =   1         TextFont        =   "System"         TextSize        =   0         Top             =   124         Underline       =   ""         UseFocusRing    =   "True"         Visible         =   True         Width           =   690         _ScrollOffset   =   0         _ScrollWidth    =   -1         BehaviorIndex   =   2      End      Begin PushButton btnDeleteScenery         AutoDeactivate  =   "True"         Bold            =   ""         Cancel          =   ""         Caption         =   "#kDelete"         Default         =   ""         Enabled         =   "False"         Height          =   27         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "tpnlMain"         Italic          =   ""         Left            =   132         LockBottom      =   "True"         LockLeft        =   ""         LockRight       =   "False"         LockTop         =   ""         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   1         TextFont        =   "System"         TextSize        =   10         Top             =   318         Underline       =   ""         Visible         =   True         Width           =   80         BehaviorIndex   =   3      End      Begin PushButton btnDeleteAircraft         AutoDeactivate  =   "True"         Bold            =   ""         Cancel          =   ""         Caption         =   "#kDelete"         Default         =   ""         Enabled         =   "False"         Height          =   27         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "tpnlMain"         Italic          =   ""         Left            =   132         LockBottom      =   "True"         LockLeft        =   ""         LockRight       =   "False"         LockTop         =   ""         Scope           =   0         TabIndex        =   5         TabPanelIndex   =   3         TextFont        =   "System"         TextSize        =   10         Top             =   534         Underline       =   ""         Visible         =   True         Width           =   80         BehaviorIndex   =   4      End      Begin PushButton btnAddPlugin         AutoDeactivate  =   "True"         Bold            =   ""         Cancel          =   ""         Caption         =   "#kAdd"         Default         =   ""         Enabled         =   True         Height          =   27         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "tpnlMain"         Italic          =   ""         Left            =   40         LockBottom      =   "True"         LockLeft        =   ""         LockRight       =   "False"         LockTop         =   ""         Scope           =   0         TabIndex        =   6         TabPanelIndex   =   2         TextFont        =   "System"         TextSize        =   10         Top             =   678         Underline       =   ""         Visible         =   True         Width           =   80         BehaviorIndex   =   5      End      Begin ListBox lstPlugins         AutoDeactivate  =   "True"         AutoHideScrollbars=   "False"         Bold            =   ""         ColumnCount     =   2         ColumnsResizable=   ""         ColumnWidths    =   "*, 60"         DataField       =   ""         DataSource      =   ""         DefaultRowHeight=   -1         Enabled         =   True         EnableDrag      =   ""         EnableDragReorder=   ""         GridLinesHorizontal=   0         GridLinesVertical=   0         HasHeading      =   "True"         HeadingIndex    =   -1         Height          =   542         HelpTag         =   ""         Hierarchical    =   ""         Index           =   -2147483648         InitialParent   =   "tpnlMain"         InitialValue    =   ""         Italic          =   ""         Left            =   40         LockBottom      =   "True"         LockLeft        =   "True"         LockRight       =   "True"         LockTop         =   "True"         RequiresSelection=   ""         Scope           =   0         ScrollbarHorizontal=   ""         ScrollBarVertical=   "True"         SelectionType   =   0         TabIndex        =   7         TabPanelIndex   =   2         TextFont        =   "System"         TextSize        =   0         Top             =   124         Underline       =   ""         UseFocusRing    =   "True"         Visible         =   True         Width           =   690         _ScrollOffset   =   0         _ScrollWidth    =   -1         BehaviorIndex   =   6      End      Begin PushButton btnDeletePlugin         AutoDeactivate  =   "True"         Bold            =   ""         Cancel          =   ""         Caption         =   "#kDelete"         Default         =   ""         Enabled         =   "False"         Height          =   27         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "tpnlMain"         Italic          =   ""         Left            =   132         LockBottom      =   "True"         LockLeft        =   ""         LockRight       =   "False"         LockTop         =   ""         Scope           =   0         TabIndex        =   8         TabPanelIndex   =   2         TextFont        =   "System"         TextSize        =   10         Top             =   678         Underline       =   ""         Visible         =   True         Width           =   80         BehaviorIndex   =   7      End      Begin ExtendedCheckBox chkEnableAllPlugins         AutoDeactivate  =   "True"         Bold            =   ""         Caption         =   "#kAll"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "tpnlMain"         Italic          =   ""         Left            =   670         LockBottom      =   "True"         LockLeft        =   ""         LockRight       =   "True"         LockTop         =   ""         pTriggerAction  =   "true"         Scope           =   0         TabIndex        =   10         TabPanelIndex   =   2         TextFont        =   "System"         TextSize        =   10         Top             =   678         Underline       =   ""         Value           =   ""         Visible         =   True         Width           =   60         BehaviorIndex   =   8      End      Begin BufferedCanvas cnvMap         AcceptFocus     =   ""         AcceptTabs      =   ""         AutoDeactivate  =   "True"         Backdrop        =   ""         Enabled         =   True         EraseBackground =   "False"         Height          =   360         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "tpnlMain"         Left            =   25         LockBottom      =   "True"         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Scope           =   0         TabIndex        =   12         TabPanelIndex   =   1         Top             =   355         UseFocusRing    =   "True"         Visible         =   True         Width           =   720         BehaviorIndex   =   9      End      Begin ExtendedCheckBox chkEnableAllCustomSceneryPackages         AutoDeactivate  =   "True"         Bold            =   ""         Caption         =   "#kAll"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "tpnlMain"         Italic          =   ""         Left            =   658         LockBottom      =   "True"         LockLeft        =   ""         LockRight       =   "True"         LockTop         =   ""         pTriggerAction  =   "true"         Scope           =   0         TabIndex        =   13         TabPanelIndex   =   1         TextFont        =   "System"         TextSize        =   10         Top             =   318         Underline       =   ""         Value           =   ""         Visible         =   True         Width           =   55         BehaviorIndex   =   10      End      Begin ListBox lstAircraft         AutoDeactivate  =   "True"         AutoHideScrollbars=   "False"         Bold            =   ""         ColumnCount     =   7         ColumnsResizable=   ""         ColumnWidths    =   "*,35,35,35,35,35,35"         DataField       =   ""         DataSource      =   ""         DefaultRowHeight=   -1         Enabled         =   True         EnableDrag      =   ""         EnableDragReorder=   ""         GridLinesHorizontal=   0         GridLinesVertical=   0         HasHeading      =   "True"         HeadingIndex    =   -1         Height          =   392         HelpTag         =   ""         Hierarchical    =   "True"         Index           =   -2147483648         InitialParent   =   "tpnlMain"         InitialValue    =   ""         Italic          =   ""         Left            =   40         LockBottom      =   "True"         LockLeft        =   "True"         LockRight       =   "True"         LockTop         =   "True"         RequiresSelection=   ""         Scope           =   0         ScrollbarHorizontal=   ""         ScrollBarVertical=   "True"         SelectionType   =   0         TabIndex        =   3         TabPanelIndex   =   3         TextFont        =   "System"         TextSize        =   0         Top             =   124         Underline       =   ""         UseFocusRing    =   "True"         Visible         =   True         Width           =   690         _ScrollOffset   =   0         _ScrollWidth    =   -1         BehaviorIndex   =   11      End      Begin Canvas cnvAircraftIcon         AcceptFocus     =   ""         AcceptTabs      =   ""         AutoDeactivate  =   "True"         Backdrop        =   ""         Enabled         =   True         EraseBackground =   "True"         Height          =   128         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "tpnlMain"         Left            =   40         LockBottom      =   "True"         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Scope           =   0         TabIndex        =   14         TabPanelIndex   =   3         Top             =   573         UseFocusRing    =   "True"         Visible         =   True         Width           =   128         BehaviorIndex   =   12      End      Begin GroupBox grpAircraftKey         AutoDeactivate  =   "True"         Bold            =   ""         Caption         =   ""         Enabled         =   True         Height          =   38         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "tpnlMain"         Italic          =   ""         Left            =   234         LockBottom      =   "True"         LockLeft        =   ""         LockRight       =   "False"         LockTop         =   ""         Scope           =   0         TabIndex        =   14         TabPanelIndex   =   3         TextFont        =   "System"         TextSize        =   0         Top             =   528         Underline       =   ""         Visible         =   True         Width           =   378         BehaviorIndex   =   13         Begin StaticText txtAircraftKey1            AutoDeactivate  =   "True"            Bold            =   ""            DataField       =   ""            DataSource      =   ""            Enabled         =   True            Height          =   27            HelpTag         =   ""            Index           =   -2147483648            InitialParent   =   "grpAircraftKey"            Italic          =   ""            Left            =   242            LockBottom      =   ""            LockLeft        =   ""            LockRight       =   ""            LockTop         =   ""            Multiline       =   "True"            Scope           =   0            TabIndex        =   1            TabPanelIndex   =   3            Text            =   "#kAircraftKey1"            TextAlign       =   0            TextColor       =   &h000000            TextFont        =   "System"            TextSize        =   9            Top             =   536            Underline       =   ""            Visible         =   True            Width           =   109            BehaviorIndex   =   14         End         Begin StaticText txtAircraftKey2            AutoDeactivate  =   "True"            Bold            =   ""            DataField       =   ""            DataSource      =   ""            Enabled         =   True            Height          =   27            HelpTag         =   ""            Index           =   -2147483648            InitialParent   =   "grpAircraftKey"            Italic          =   ""            Left            =   369            LockBottom      =   ""            LockLeft        =   ""            LockRight       =   ""            LockTop         =   ""            Multiline       =   "True"            Scope           =   0            TabIndex        =   1            TabPanelIndex   =   3            Text            =   "#kAircraftKey2"            TextAlign       =   0            TextColor       =   &h000000            TextFont        =   "System"            TextSize        =   9            Top             =   536            Underline       =   ""            Visible         =   True            Width           =   109            BehaviorIndex   =   15         End         Begin StaticText txtAircraftKey3            AutoDeactivate  =   "True"            Bold            =   ""            DataField       =   ""            DataSource      =   ""            Enabled         =   True            Height          =   27            HelpTag         =   ""            Index           =   -2147483648            InitialParent   =   "grpAircraftKey"            Italic          =   ""            Left            =   486            LockBottom      =   ""            LockLeft        =   ""            LockRight       =   ""            LockTop         =   ""            Multiline       =   "True"            Scope           =   0            TabIndex        =   1            TabPanelIndex   =   3            Text            =   "#kAircraftKey3"            TextAlign       =   0            TextColor       =   &h000000            TextFont        =   "System"            TextSize        =   9            Top             =   536            Underline       =   ""            Visible         =   True            Width           =   109            BehaviorIndex   =   16         End      End      Begin GroupBox grpCustomSceneryKey         AutoDeactivate  =   "True"         Bold            =   ""         Caption         =   ""         Enabled         =   True         Height          =   38         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "tpnlMain"         Italic          =   ""         Left            =   248         LockBottom      =   "True"         LockLeft        =   ""         LockRight       =   "False"         LockTop         =   ""         Scope           =   0         TabIndex        =   11         TabPanelIndex   =   1         TextFont        =   "System"         TextSize        =   0         Top             =   312         Underline       =   ""         Visible         =   True         Width           =   378         BehaviorIndex   =   17         Begin StaticText txtCustomSceneryKey1            AutoDeactivate  =   "True"            Bold            =   ""            DataField       =   ""            DataSource      =   ""            Enabled         =   True            Height          =   27            HelpTag         =   ""            Index           =   -2147483648            InitialParent   =   "grpCustomSceneryKey"            Italic          =   ""            Left            =   254            LockBottom      =   ""            LockLeft        =   ""            LockRight       =   ""            LockTop         =   ""            Multiline       =   "True"            Scope           =   0            TabIndex        =   1            TabPanelIndex   =   1            Text            =   "#kSceneryPackageKey1"            TextAlign       =   0            TextColor       =   &h000000            TextFont        =   "System"            TextSize        =   9            Top             =   319            Underline       =   ""            Visible         =   True            Width           =   109            BehaviorIndex   =   18         End         Begin StaticText txtCustomSceneryKey2            AutoDeactivate  =   "True"            Bold            =   ""            DataField       =   ""            DataSource      =   ""            Enabled         =   True            Height          =   27            HelpTag         =   ""            Index           =   -2147483648            InitialParent   =   "grpCustomSceneryKey"            Italic          =   ""            Left            =   381            LockBottom      =   ""            LockLeft        =   ""            LockRight       =   ""            LockTop         =   ""            Multiline       =   "True"            Scope           =   0            TabIndex        =   1            TabPanelIndex   =   1            Text            =   "#kSceneryPackageKey2"            TextAlign       =   0            TextColor       =   &h000000            TextFont        =   "System"            TextSize        =   9            Top             =   319            Underline       =   ""            Visible         =   True            Width           =   109            BehaviorIndex   =   19         End         Begin StaticText txtCustomSceneryKey3            AutoDeactivate  =   "True"            Bold            =   ""            DataField       =   ""            DataSource      =   ""            Enabled         =   True            Height          =   27            HelpTag         =   ""            Index           =   -2147483648            InitialParent   =   "grpCustomSceneryKey"            Italic          =   ""            Left            =   511            LockBottom      =   ""            LockLeft        =   ""            LockRight       =   ""            LockTop         =   ""            Multiline       =   "True"            Scope           =   0            TabIndex        =   1            TabPanelIndex   =   1            Text            =   "#kSceneryPackageKey3"            TextAlign       =   0            TextColor       =   &h000000            TextFont        =   "System"            TextSize        =   9            Top             =   319            Underline       =   ""            Visible         =   True            Width           =   109            BehaviorIndex   =   20         End      End      Begin PushButton btnAddAircraft         AutoDeactivate  =   "True"         Bold            =   ""         Cancel          =   ""         Caption         =   "#kAdd"         Default         =   ""         Enabled         =   "False"         Height          =   27         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "tpnlMain"         Italic          =   ""         Left            =   40         LockBottom      =   "True"         LockLeft        =   ""         LockRight       =   "False"         LockTop         =   ""         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   3         TextFont        =   "System"         TextSize        =   10         Top             =   534         Underline       =   ""         Visible         =   True         Width           =   80         BehaviorIndex   =   21      End      Begin ListBox lstCSLs         AutoDeactivate  =   "True"         AutoHideScrollbars=   "False"         Bold            =   ""         ColumnCount     =   2         ColumnsResizable=   ""         ColumnWidths    =   "*, 60"         DataField       =   ""         DataSource      =   ""         DefaultRowHeight=   -1         Enabled         =   True         EnableDrag      =   ""         EnableDragReorder=   ""         GridLinesHorizontal=   0         GridLinesVertical=   0         HasHeading      =   "True"         HeadingIndex    =   -1         Height          =   542         HelpTag         =   ""         Hierarchical    =   ""         Index           =   -2147483648         InitialParent   =   "tpnlMain"         InitialValue    =   ""         Italic          =   ""         Left            =   40         LockBottom      =   "True"         LockLeft        =   "True"         LockRight       =   "True"         LockTop         =   "True"         RequiresSelection=   ""         Scope           =   0         ScrollbarHorizontal=   ""         ScrollBarVertical=   "True"         SelectionType   =   0         TabIndex        =   1         TabPanelIndex   =   4         TextFont        =   "System"         TextSize        =   0         Top             =   124         Underline       =   ""         UseFocusRing    =   "True"         Visible         =   True         Width           =   690         _ScrollOffset   =   0         _ScrollWidth    =   -1         BehaviorIndex   =   22      End      Begin ExtendedCheckBox chkEnableAllCSLs         AutoDeactivate  =   "True"         Bold            =   ""         Caption         =   "#kAll"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "tpnlMain"         Italic          =   ""         Left            =   670         LockBottom      =   "True"         LockLeft        =   ""         LockRight       =   "True"         LockTop         =   ""         pTriggerAction  =   "true"         Scope           =   0         TabIndex        =   16         TabPanelIndex   =   4         TextFont        =   "System"         TextSize        =   10         Top             =   678         Underline       =   ""         Value           =   ""         Visible         =   True         Width           =   60         BehaviorIndex   =   23      End      Begin PushButton btnAddCSL         AutoDeactivate  =   "True"         Bold            =   ""         Cancel          =   ""         Caption         =   "#kAdd"         Default         =   ""         Enabled         =   True         Height          =   27         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "tpnlMain"         Italic          =   ""         Left            =   40         LockBottom      =   "True"         LockLeft        =   ""         LockRight       =   "False"         LockTop         =   ""         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   4         TextFont        =   "System"         TextSize        =   10         Top             =   678         Underline       =   ""         Visible         =   True         Width           =   80         BehaviorIndex   =   24      End      Begin PushButton btnDeleteCSL         AutoDeactivate  =   "True"         Bold            =   ""         Cancel          =   ""         Caption         =   "#kDelete"         Default         =   ""         Enabled         =   "False"         Height          =   27         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "tpnlMain"         Italic          =   ""         Left            =   132         LockBottom      =   "True"         LockLeft        =   ""         LockRight       =   "False"         LockTop         =   ""         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   4         TextFont        =   "System"         TextSize        =   10         Top             =   678         Underline       =   ""         Visible         =   True         Width           =   80         BehaviorIndex   =   25      End   End   Begin Canvas cnvLogo      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   "True"      Backdrop        =   1638712966      Enabled         =   True      EraseBackground =   "True"      Height          =   64      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   20      LockBottom      =   ""      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      Top             =   14      UseFocusRing    =   "True"      Visible         =   True      Width           =   64      BehaviorIndex   =   26   End   Begin StaticText txtXPlaneFolderCaption      AutoDeactivate  =   "True"      Bold            =   "True"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   96      LockBottom      =   ""      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Multiline       =   ""      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      Text            =   "#kXPlaneFolder"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   10      Top             =   26      Underline       =   ""      Visible         =   True      Width           =   126      BehaviorIndex   =   27   End   Begin StaticText txtXplaneFolder      AutoDeactivate  =   "True"      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   188      LockBottom      =   ""      LockLeft        =   "True"      LockRight       =   "True"      LockTop         =   ""      Multiline       =   ""      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      Text            =   "Untitled"      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   10      Top             =   54      Underline       =   ""      Visible         =   True      Width           =   407      BehaviorIndex   =   28   End   Begin PushButton btnSetXPlaneFolder      AutoDeactivate  =   "True"      Bold            =   ""      Cancel          =   ""      Caption         =   "#kSet"      Default         =   ""      Enabled         =   True      Height          =   27      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   96      LockBottom      =   ""      LockLeft        =   ""      LockRight       =   "True"      LockTop         =   ""      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TextFont        =   "System"      TextSize        =   10      Top             =   51      Underline       =   ""      Visible         =   True      Width           =   80      BehaviorIndex   =   29   End   Begin Timer tmrMapRefresh      Height          =   32      Index           =   -2147483648      Left            =   713      Mode            =   2      Period          =   100      Scope           =   0      TabPanelIndex   =   0      Top             =   -61      Width           =   32      BehaviorIndex   =   30   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Open()		  // Check whether to show the CSL tab		  if not CSL.checkXPlaneFolder(App.pXPlaneFolder) then		    tpnlMain.remove(3)		    pCSLsEnabled = false		  end if		  		  displayXPlaneFolder()		  scanXPlaneFolder()		  		End Sub	#tag EndEvent	#tag Event		Sub Close()		  saveState()		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Sub displayXPlaneFolder()		  txtXplaneFolder.text = App.pXPlaneFolder.absolutePath		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub scanXPlaneFolder()		  dim containerFolderItem as FolderItem		  dim count, i, index as integer		  		  // Stop change events from firing		  pTriggerChangeEvents = false		  		  // Clear the listboxes		  lstCustomSceneryPackages.deleteAllRows		  lstPlugins.deleteAllRows		  lstAircraft.deleteAllRows		  lstCSLs.deleteAllRows		  		  // Reenable change events		  pTriggerChangeEvents = true		  		  containerFolderItem = CustomSceneryPackage.getRootFolder()		  count = containerFolderItem.count		  		  for i = 1 to count		    dim folderItem as FolderItem = containerFolderItem.trueItem(i)		    		    if folderItem <> nil then		      if CustomSceneryPackage.isValid(folderItem) then		        dim customSceneryPackage as CustomSceneryPackage		        customSceneryPackage = new CustomSceneryPackage(folderItem.name, folderItem, true)		        customSceneryPackage.populateListBoxEntry(lstCustomSceneryPackages)		      end if		    end if		  next		  		  containerFolderItem = CustomSceneryPackage.getRootFolder(false)		  count = containerFolderItem.count		  		  for i = 1 to count		    dim folderItem as FolderItem = containerFolderItem.trueItem(i)		    		    if folderItem <> nil then		      if CustomSceneryPackage.isValid(folderItem) then		        dim customSceneryPackage as CustomSceneryPackage		        customSceneryPackage = new CustomSceneryPackage(folderItem.name, folderItem, false)		        customSceneryPackage.populateListBoxEntry(lstCustomSceneryPackages)		      end if		    end if		  next		  		  containerFolderItem = Plugin.getRootFolder()		  count = containerFolderItem.Count		  		  for i = 1 to count		    dim folderItem as FolderItem = containerFolderItem.TrueItem(i)		    		    if folderItem <> nil then		      if Plugin.isValid(folderItem) then		        dim plugin as Plugin		        plugin = new Plugin(folderItem.name, folderItem, true)		        plugin.populateListBoxEntry(lstPlugins)		      end if		    end if		  next		  		  containerFolderItem = Plugin.getRootFolder(false)		  count = containerFolderItem.Count		  		  for i = 1 to count		    dim folderItem as FolderItem = containerFolderItem.TrueItem(i)		    		    if folderItem <> nil then		      if Plugin.isValid(folderItem) then		        dim plugin as Plugin		        plugin = new Plugin(folderItem.name, folderItem, false)		        plugin.populateListBoxEntry(lstPlugins)		      end if		    end if		  next		  		  containerFolderItem = Aircraft.getRootFolder()		  count = containerFolderItem.Count		  index = 0		  		  for i = 1 to count		    dim folderItem as FolderItem = containerFolderItem.TrueItem(i)		    		    if folderItem <> nil then		      if Aircraft.isValid(folderItem) then		        dim aircraft as Aircraft		        aircraft = new Aircraft(folderItem.name, folderItem, true)		        aircraft.populateListBoxEntry(lstAircraft)		      elseif AircraftFolder.isValid(folderItem) then		        // It's a valid AircraftContainer		        dim aircraftFolder as new AircraftFolder(folderItem.Name, folderItem, true)		        aircraftFolder.populateListBoxEntry(lstAircraft)		      else		        // Don't display anything else		      End if		    end if		  next		  		  if pCSLsEnabled then		    containerFolderItem = CSL.getRootFolder()		    count = containerFolderItem.Count		    		    for i = 1 to count		      dim folderItem as FolderItem = containerFolderItem.TrueItem(i)		      		      if folderItem <> nil then		        if CSL.isValid(folderItem) then		          dim csl as CSL		          csl = new CSL(folderItem.name, folderItem, true)		          csl.populateListBoxEntry(lstCSLs)		        end if		      end if		    next		    		    containerFolderItem = CSL.getRootFolder(false)		    count = containerFolderItem.Count		    		    for i = 1 to count		      dim folderItem as FolderItem = containerFolderItem.TrueItem(i)		      		      if folderItem <> nil then		        if CSL.isValid(folderItem) then		          dim csl as CSL		          csl = new CSL(folderItem.name, folderItem, false)		          csl.populateListBoxEntry(lstCSLs)		        end if		      end if		    next		  end if		  		  		  // Sort the listboxes		  lstCustomSceneryPackages.sort		  lstPlugins.sort		  lstAircraft.sort		  lstCSLs.sort		  		  refreshEnableAllCheckBox(kListCustomSceneryPackages)		  refreshEnableAllCheckBox(kListPlugins)		  refreshEnableAllCheckBox(kListCSLs)		  		  refreshMap()		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub refreshEnableAllCheckBox(listType as integer)		  dim checkBox as ExtendedCheckBox		  dim listBox as ListBox		  dim allSelected as boolean = true		  		  listBox = getListBox(listType)		  checkBox = getEnableAllCheckBox(listType)		  		  dim i as integer		  		  for i = 0 to listBox.lastIndex		    dim instance as Addon = listBox.cellTag(i, 0)		    if not instance.pEnabled then allSelected = false		  next		  		  checkBox.setValue(allSelected, false)		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub enableAll(listType as integer, selected as boolean)		  dim listBox as ListBox = getListBox(listType)		  dim i as integer		  		  for i = 0 to listBox.lastIndex		    dim instance as Addon = listBox.cellTag(i, 0)		    instance.enable(selected)		  next		  		  scanXPlaneFolder()		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function getEnableAllCheckBox(listType as integer) As ExtendedCheckBox		  select case listType		  case kListCustomSceneryPackages		    return chkEnableAllCustomSceneryPackages		  case kListPlugins		    return chkEnableAllPlugins		  case kListCSLs		    return chkEnableAllCSLs		  end select		  		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub plotPackages(g as Graphics)		  dim i as integer		  dim selectedPackage as customSceneryPackage		  		  for i = 0 to lstCustomSceneryPackages.lastIndex		    dim customSceneryPackage as CustomSceneryPackage = lstCustomSceneryPackages.cellTag(i, 0)		    		    if lstCustomSceneryPackages.listIndex = i then		      // Selected package, store it for drawing last		      selectedPackage = customSceneryPackage		    else		      // Draw the package		      customSceneryPackage.plotOnMap(g, CustomSceneryPackage.kPlanetEarth, false)		    end if		  next		  		  // Draw the selected package last so that the highlight always gets drawn on top of everything else		  if selectedPackage <> nil then		    selectedPackage.plotOnMap(g, CustomSceneryPackage.kPlanetEarth, true)		  end if		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub refreshMap()		  cnvMap.refresh(false)		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub addSceneryPackage()		  dim dialog as SelectFolderDialog		  dim folderItem as FolderItem		  		  dim zipType As new FileType		  zipType.Name = "application/zip"		  zipType.MacType = "ZIP "		  zipType.Extensions = "zip"		  		  while true		    folderItem = getOpenFolderItem(zipType)		    		    if (folderItem = nil) then		      return		    end if		    		    dim sourceFolderItem as FolderItem = Addon.extractZipToTemporaryLocation(folderItem)		    if sourceFolderItem = nil then return		    sourceFolderItem = AddOn.searchForAddon(sourceFolderItem, "CustomSceneryPackage")		    		    if sourceFolderItem = nil then		      msgBox(kErrorNotValidCompressedSceneryPackage)		    else		      CustomSceneryPackage.install(sourceFolderItem)		      scanXPlaneFolder()		      return		    end if		  wend		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub addPlugin()		  dim dialog as SelectFolderDialog		  dim folderItem as FolderItem		  		  dim zipType As new FileType		  zipType.Name = "application/zip"		  zipType.MacType = "ZIP "		  zipType.Extensions = "zip"		  		  while true		    folderItem = getOpenFolderItem(zipType)		    		    if (folderItem = nil) then		      return		    end if		    		    dim sourceFolderItem as FolderItem = Addon.extractZipToTemporaryLocation(folderItem)		    if sourceFolderItem = nil then return		    sourceFolderItem = AddOn.searchForAddon(sourceFolderItem, "Plugin")		    		    if sourceFolderItem = nil then		      msgBox(kErrorNotValidCompressedPluginPackage)		    else		      Plugin.install(sourceFolderItem)		      scanXPlaneFolder()		      return		    end if		  wend		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub selectNearestPackage(x as integer, y as integer)		  dim i as integer		  dim minDistance as double = 10000		  dim closestPackage as CustomSceneryPackage = nil		  		  for i = 0 to lstCustomSceneryPackages.lastIndex		    dim customSceneryPackage as CustomSceneryPackage = lstCustomSceneryPackages.cellTag(i, 0)		    dim distance as double = customSceneryPackage.getMinDistanceFrom(x, y)		    if distance < minDistance then		      minDistance = distance		      closestPackage = customSceneryPackage		    end if		    // If the user is on top of a package then there's no point iterating further		    if minDistance = 0.0 then exit		  next		  		  if closestPackage <> nil then		    for i = 0 to lstCustomSceneryPackages.lastIndex		      if lstCustomSceneryPackages.cellTag(i, 0) = closestPackage then		        lstCustomSceneryPackages.listIndex = i		        return		      end if		    next		  end if		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function getListBox(listType as integer) As ListBox		  select case listType		  case kListCustomSceneryPackages		    return lstCustomSceneryPackages		  case kListPlugins		    return lstPlugins		  case kListAircraft		    return lstAircraft		  case kListCSLs		    return lstCSLs		  end select		  		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub refreshAircraftDisplay()		  if lstAircraft.listIndex > -1 then		    // An item is selected		    if lstAircraft.cellTag(lstAircraft.listIndex, 0) isa Aircraft then		      // An aircraft is selected		      dim aircraft as Aircraft = lstAircraft.cellTag(lstAircraft.listIndex, 0)		      aircraft.displayDetails(cnvAircraftIcon)		    elseif lstAircraft.cellTag(lstAircraft.listIndex, 0) isa AircraftFolder then		      // An AircraftFolder is selected		      dim aircraftFolder as AircraftFolder = lstAircraft.cellTag(lstAircraft.listIndex, 0)		      aircraftFolder.displayDetails(cnvAircraftIcon)		    else		      // Should never get here (only Aircraft and AircraftFolders are added to the ListBox in the first place)		    end if		  else		    // Nothing selected, clear the info panel		    		  end if		  		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub deleteSceneryPackage()		  dim customSceneryPackage as CustomSceneryPackage = lstCustomSceneryPackages.cellTag(lstCustomSceneryPackages.listIndex, 0)		  customSceneryPackage.delete()		  scanXPlaneFolder()		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub deletePlugin()		  dim plugin as Plugin = lstPlugins.cellTag(lstPlugins.listIndex, 0)		  plugin.delete()		  scanXPlaneFolder()		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub addAircraft()		  dim dialog as SelectFolderDialog		  dim folderItem as FolderItem		  		  dim zipType As new FileType		  zipType.Name = "application/zip"		  zipType.MacType = "ZIP "		  zipType.Extensions = "zip"		  		  while true		    folderItem = getOpenFolderItem(zipType)		    		    if (folderItem = nil) then		      return		    end if		    		    dim sourceFolderItem as FolderItem = Addon.extractZipToTemporaryLocation(folderItem)		    if sourceFolderItem = nil then return		    sourceFolderItem = AddOn.searchForAddon(sourceFolderItem, "Aircraft")		    		    if sourceFolderItem = nil then		      msgBox(kErrorNotValidCompressedAircraftPackage)		    else		      dim destinationAircraftFolder as AircraftFolder = lstAircraft.cellTag(lstAircraft.listIndex, 0)		      Aircraft.install(sourceFolderItem, destinationAircraftFolder.pFolderItem)		      return		    end if		  wend		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub deleteAircraft()		  dim aircraft as Aircraft = lstAircraft.cellTag(lstAircraft.listIndex, 0)		  aircraft.delete()		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub addCSL()		  dim dialog as SelectFolderDialog		  dim folderItem as FolderItem		  		  dim zipType As new FileType		  zipType.Name = "application/zip"		  zipType.MacType = "ZIP "		  zipType.Extensions = "zip"		  		  while true		    folderItem = getOpenFolderItem(zipType)		    		    if (folderItem = nil) then		      return		    end if		    		    dim sourceFolderItem as FolderItem = Addon.extractZipToTemporaryLocation(folderItem)		    if sourceFolderItem = nil then return		    sourceFolderItem = AddOn.searchForAddon(sourceFolderItem, "CSL")		    		    if sourceFolderItem = nil then		      msgBox(kErrorNotValidCompressedPluginPackage)		    else		      CSL.install(sourceFolderItem)		      scanXPlaneFolder()		      return		    end if		  wend		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub deleteCSL()		  dim csl as CSL = lstCSLs.cellTag(lstCSLs.listIndex, 0)		  csl.delete()		  scanXPlaneFolder()		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub saveState()		  dim i as integer		  		  for i = 0 to lstCustomSceneryPackages.lastIndex		    dim instance as Addon = lstCustomSceneryPackages.cellTag(i, 0)		    instance.saveState()		  next		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function underscoreSensitiveCompare(string1 as String, string2 as String, ByRef result as integer) As Boolean		  // This method works the same way as REALbasic behaviour - the return value is used to determine whether to use the default RB sort,		  // and the ByRef result parameter is used to send back the compare result		  		  // Override sort so that items beginning with '_' sort to the top		  if string1.left(1) <> "_" and string2.left(1) <> "_" then		    // Default sorting		    return false		  elseif string1.left(1) = "_" and string2.left(1) <> "_" then		    // '_' sorts above		    result = -1		    return true		  elseif string1.left(1) <>"_" and string2.left(1) = "_" then		    // '_' sorts above		    result = 1		    return true		  else		    // Both cells start with '_', sort from the second character		    result = strcomp(string1.mid(1), string2.mid(1), 1)		    return true		  end if		  		End Function	#tag EndMethod	#tag Property, Flags = &h0		pTriggerChangeEvents As boolean = true	#tag EndProperty	#tag Property, Flags = &h0		pCSLsEnabled As Boolean = true	#tag EndProperty	#tag Constant, Name = kGo, Type = String, Dynamic = True, Default = \"Go", Scope = Public		#Tag Instance, Platform = Any, Language = fr, Definition  = \"D\xC3\xA9marrer"		#Tag Instance, Platform = Any, Language = ca, Definition  = \"Endavant"	#tag EndConstant	#tag Constant, Name = kSet, Type = String, Dynamic = True, Default = \"Set\xE2\x80\xA6", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Setear\xE2\x80\xA6"		#Tag Instance, Platform = Any, Language = fr, Definition  = \"R\xC3\xA9glages\xE2\x80\xA6"		#Tag Instance, Platform = Any, Language = ca, Definition  = \"Tria..."	#tag EndConstant	#tag Constant, Name = kXPlaneFolder, Type = String, Dynamic = True, Default = \"X-Plane\xC2\xAE Folder:", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Carpeta X-Plane\xC2\xAE:"		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Dossier X-Plane\xC2\xAE:"		#Tag Instance, Platform = Any, Language = ca, Definition  = \"Carpeta X-Plane\xC2\xAE:"	#tag EndConstant	#tag Constant, Name = kError, Type = String, Dynamic = True, Default = \"Error: \"${1}\"", Scope = Public		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Erreur.\"${1}\""		#Tag Instance, Platform = Any, Language = ca, Definition  = \"Error: \xC2\xAB${1}\xC2\xBB"	#tag EndConstant	#tag Constant, Name = kExtractionFailed, Type = String, Dynamic = True, Default = \"Extraction of \"${1}\" failed: \"${2}\"", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Extracci\xC3\xB3n de \"${1}\" fall\xC3\xB3: \"${2}\""		#Tag Instance, Platform = Any, Language = fr, Definition  = \"L\'extraction de \"{1}\" a \xC3\xA9chou\xC3\xA9e:\"{2}\""		#Tag Instance, Platform = Any, Language = ca, Definition  = \"L\'extracci\xC3\xB3 de \xC2\xAB${1}\xC2\xBB ha fallat: \xC2\xAB${2}\xC2\xBB"	#tag EndConstant	#tag Constant, Name = kComplete, Type = String, Dynamic = True, Default = \"Complete.", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Completo."		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Termin\xC3\xA9."		#Tag Instance, Platform = Any, Language = ca, Definition  = \"Completat."	#tag EndConstant	#tag Constant, Name = kGivingUp, Type = String, Dynamic = True, Default = \"Giving up.", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Abandonando."		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Abandon."		#Tag Instance, Platform = Any, Language = ca, Definition  = \"Deixant-ho."	#tag EndConstant	#tag Constant, Name = kSeparator, Type = String, Dynamic = False, Default = \"----", Scope = Public	#tag EndConstant	#tag Constant, Name = kInstallComplete, Type = String, Dynamic = True, Default = \"Your OpenSceneryX installation is now Complete.", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Su instalaci\xC3\xB3n de OpenSceneryX ya fue Completada."		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Votre installation OpenSceneryX est compl\xC3\xA8te."		#Tag Instance, Platform = Any, Language = ca, Definition  = \"S\'ha completat la insta\xC5\x80laci\xC3\xB3 del vostre OpenSceneryX."	#tag EndConstant	#tag Constant, Name = kFilesRemain, Type = String, Dynamic = True, Default = \"${1} remain", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"${1} restantes"		#Tag Instance, Platform = Any, Language = fr, Definition  = \"${1} restant"		#Tag Instance, Platform = Any, Language = ca, Definition  = \"en resten ${1}"	#tag EndConstant	#tag Constant, Name = kCollectingLocalFileInformation, Type = String, Dynamic = True, Default = \"Collecting local file information\xE2\x80\xA6", Scope = Public		#Tag Instance, Platform = Any, Language = es, Definition  = \"Recabando informaci\xC3\xB3n de archivos locales\xE2\x80\xA6"		#Tag Instance, Platform = Any, Language = fr, Definition  = \"Collecte des informations locales\xE2\x80\xA6"		#Tag Instance, Platform = Any, Language = ca, Definition  = \"S\'est\xC3\xA0 recollint informaci\xC3\xB3 dels fitxers locals..."	#tag EndConstant	#tag Constant, Name = kAdd, Type = String, Dynamic = True, Default = \"Install\xE2\x80\xA6", Scope = Public	#tag EndConstant	#tag Constant, Name = kDelete, Type = String, Dynamic = True, Default = \"Delete\xE2\x80\xA6", Scope = Public	#tag EndConstant	#tag Constant, Name = kEnabled, Type = String, Dynamic = True, Default = \"enabled", Scope = Public	#tag EndConstant	#tag Constant, Name = kColumnTitleName, Type = String, Dynamic = True, Default = \"Name", Scope = Public	#tag EndConstant	#tag Constant, Name = kColumnTitleEnabled, Type = String, Dynamic = True, Default = \"Enable", Scope = Public	#tag EndConstant	#tag Constant, Name = kListCustomSceneryPackages, Type = Double, Dynamic = False, Default = \"0", Scope = Public	#tag EndConstant	#tag Constant, Name = kListPlugins, Type = Double, Dynamic = False, Default = \"1", Scope = Public	#tag EndConstant	#tag Constant, Name = kListCSLs, Type = Double, Dynamic = False, Default = \"3", Scope = Public	#tag EndConstant	#tag Constant, Name = kColumnTitleEarthScenery, Type = String, Dynamic = True, Default = \"ES", Scope = Public	#tag EndConstant	#tag Constant, Name = kColumnTitleMarsScenery, Type = String, Dynamic = True, Default = \"MS", Scope = Public	#tag EndConstant	#tag Constant, Name = kColumnTitleLibrary, Type = String, Dynamic = True, Default = \"L", Scope = Public	#tag EndConstant	#tag Constant, Name = kColumnTitleEarthAirportData, Type = String, Dynamic = True, Default = \"EA", Scope = Public	#tag EndConstant	#tag Constant, Name = kColumnTitleMarsAirportData, Type = String, Dynamic = True, Default = \"MA", Scope = Public	#tag EndConstant	#tag Constant, Name = kLocateSceneryPackagePrompt, Type = String, Dynamic = True, Default = \"Locate the scenery package to install\x2C usually a zip file you have downloaded.", Scope = Public	#tag EndConstant	#tag Constant, Name = kLocateSceneryPackageTitle, Type = String, Dynamic = True, Default = \"Locate the scenery package you wish to install", Scope = Public	#tag EndConstant	#tag Constant, Name = kErrorNotValidCompressedSceneryPackage, Type = String, Dynamic = True, Default = \"You did not select a compressed scenery package.  Please try again.", Scope = Public	#tag EndConstant	#tag Constant, Name = kAll, Type = String, Dynamic = True, Default = \"All", Scope = Public	#tag EndConstant	#tag Constant, Name = kTabTitleCustomSceneryPackages, Type = String, Dynamic = True, Default = \"Custom Scenery Packages", Scope = Public	#tag EndConstant	#tag Constant, Name = kTabTitlePlugins, Type = String, Dynamic = True, Default = \"Plugins", Scope = Public	#tag EndConstant	#tag Constant, Name = kTabTitleAircraft, Type = String, Dynamic = True, Default = \"Aircraft", Scope = Public	#tag EndConstant	#tag Constant, Name = kEnabledItemSwapped, Type = String, Dynamic = True, Default = \"Note: An enabled item named \'${1}\' already exists\x2C so the two items have been swapped: The enabled item is now disabled\x2C and the disabled item is now enabled.", Scope = Public	#tag EndConstant	#tag Constant, Name = kErrorItemWithSameNameExists, Type = String, Dynamic = True, Default = \"The addon was not installed because a file or folder named \'${1}\' already exists in the destination folder. Please either remove the existing item\x2C disable the existing item\x2C or rename the item being installed.", Scope = Public	#tag EndConstant	#tag Constant, Name = kAnEnabled, Type = String, Dynamic = True, Default = \"An enabled", Scope = Public	#tag EndConstant	#tag Constant, Name = kDisabled, Type = String, Dynamic = True, Default = \"disabled", Scope = Public	#tag EndConstant	#tag Constant, Name = kDisabledItemSwapped, Type = String, Dynamic = True, Default = \"Note: A disabled item named \'${1}\' already exists\x2C so the two items have been swapped: The enabled item is now disabled\x2C and the disabled item is now enabled.", Scope = Public	#tag EndConstant	#tag Constant, Name = kConfirmDelete, Type = String, Dynamic = True, Default = \"Are you sure you want to PERMANENTLY delete the currently ${1} scenery package titled \'${2}\'\?", Scope = Public	#tag EndConstant	#tag Constant, Name = kSceneryPackageKey1, Type = String, Dynamic = True, Default = \"L - Library\rES - Earth Scenery", Scope = Public	#tag EndConstant	#tag Constant, Name = kSceneryPackageKey2, Type = String, Dynamic = True, Default = \"MS - Mars Scenery\rEA - Earth Airports", Scope = Public	#tag EndConstant	#tag Constant, Name = kSceneryPackageKey3, Type = String, Dynamic = True, Default = \"MA - Mars Airports", Scope = Public	#tag EndConstant	#tag Constant, Name = kErrorNotValidCompressedPluginPackage, Type = String, Dynamic = True, Default = \"You did not select a compressed plugin.  Please try again.", Scope = Public	#tag EndConstant	#tag Constant, Name = kColumnTitleSounds, Type = String, Dynamic = True, Default = \"S", Scope = Public	#tag EndConstant	#tag Constant, Name = kColumnTitleAirfoils, Type = String, Dynamic = True, Default = \"A", Scope = Public	#tag EndConstant	#tag Constant, Name = kColumnTitle3dCockpit, Type = String, Dynamic = True, Default = \"3D", Scope = Public	#tag EndConstant	#tag Constant, Name = kColumnTitleWeapons, Type = String, Dynamic = True, Default = \"W", Scope = Public	#tag EndConstant	#tag Constant, Name = kAircraftKey1, Type = String, Dynamic = True, Default = \"3D - 3D Cockpit\rA - Airfoils(s)", Scope = Public	#tag EndConstant	#tag Constant, Name = kAircraftKey2, Type = String, Dynamic = True, Default = \"S - Sound(s)\rW - Weapon(s)", Scope = Public	#tag EndConstant	#tag Constant, Name = kColumnTitlePlugins, Type = String, Dynamic = True, Default = \"P", Scope = Public	#tag EndConstant	#tag Constant, Name = kAircraftKey3, Type = String, Dynamic = True, Default = \"P - Plugin(s)\rG - Goodway enabled", Scope = Public	#tag EndConstant	#tag Constant, Name = kColumnTitleGoodway, Type = String, Dynamic = True, Default = \"G", Scope = Public	#tag EndConstant	#tag Constant, Name = kErrorNotValidCompressedAircraftPackage, Type = String, Dynamic = True, Default = \"You did not select a compressed aircraft package.  Please try again.", Scope = Public	#tag EndConstant	#tag Constant, Name = kTabTitleCSLs, Type = String, Dynamic = True, Default = \"CSLs", Scope = Public	#tag EndConstant	#tag Constant, Name = kListAircraft, Type = Double, Dynamic = False, Default = \"2", Scope = Public	#tag EndConstant	#tag Constant, Name = kColumnTitleShownOnMap, Type = String, Dynamic = True, Default = \"Plot", Scope = Public	#tag EndConstant#tag EndWindowCode#tag Events btnAddScenery	#tag Event		Sub Action()		  addSceneryPackage()		  		End Sub	#tag EndEvent#tag EndEvents#tag Events lstCustomSceneryPackages	#tag Event		Sub Open()		  me.heading(0) = kColumnTitleName		  me.heading(1) = kColumnTitleLibrary		  me.heading(2) = kColumnTitleEarthScenery		  me.heading(3) = kColumnTitleMarsScenery		  me.heading(4) = kColumnTitleEarthAirportData		  me.heading(5) = kColumnTitleMarsAirportData		  me.heading(6) = kColumnTitleShownOnMap		  		  me.columnType(6) = ListBox.TypeCheckBox		  		  me.heading(me.columnCount - 1) = kColumnTitleEnabled		  me.columnType(me.columnCount - 1) = ListBox.TypeCheckBox		  		  me.sortedColumn = 0		  me.columnSortDirection(0) = 1		  		  dim i as integer		  for i = 1 to me.columnCount - 1		    me.columnAlignment(i) = ListBox.AlignCenter		  next		End Sub	#tag EndEvent	#tag Event		Sub Change()		  if (pTriggerChangeEvents) then		    btnDeleteScenery.enabled = (me.selCount > 0)		    refreshMap()		  end if		End Sub	#tag EndEvent	#tag Event		Sub CellAction(row As Integer, column As Integer)		  dim customSceneryPackage as CustomSceneryPackage = me.cellTag(row, 0)		  		  if column = me.columnCount - 1 then		    // Enable / disable		    customSceneryPackage.enable(me.cellCheck(row, column))		  elseif column = 6 then		    // Show / Hide		    customSceneryPackage.shownOnMap(me.cellCheck(row, column))		  end if		  		  refreshMap()		End Sub	#tag EndEvent	#tag Event		Function CellTextPaint(g As Graphics, row As Integer, column As Integer, x as Integer, y as Integer) As Boolean		  'if 1=(row+column) mod 2 then		  'g.foreColor=rgb(255,0,0)		  'else		  'g.foreColor=rgb(0,0,0)		  'end		End Function	#tag EndEvent	#tag Event		Sub DoubleClick()		  Addon(me.cellTag(me.listIndex, 0)).doubleClicked()		End Sub	#tag EndEvent	#tag Event		Function CompareRows(row1 as Integer, row2 as Integer, column as Integer, ByRef result as Integer) As Boolean		  if column = 0 then		    return underscoreSensitiveCompare(me.cell(row1, column), me.cell(row2, column), result)		  else		    return false		  end if		End Function	#tag EndEvent#tag EndEvents#tag Events btnDeleteScenery	#tag Event		Sub Action()		  deleteSceneryPackage()		End Sub	#tag EndEvent#tag EndEvents#tag Events btnDeleteAircraft	#tag Event		Sub Action()		  // Store the selected index before the delete		  dim selectedIndex as integer = lstAircraft.listIndex		  		  deleteAircraft()		  		  // Find the containing listbox line		  dim i as integer		  for i = lstAircraft.listIndex - 1 downto 1		    if lstAircraft.cellTag(i, 0) isa AircraftFolder then		      // Collapse and expand the row to refresh its contents		      lstAircraft.expanded(i) = false		      lstAircraft.refresh()		      lstAircraft.expanded(i) = true		      return		    end if		  next		  		End Sub	#tag EndEvent#tag EndEvents#tag Events btnAddPlugin	#tag Event		Sub Action()		  addPlugin()		  		End Sub	#tag EndEvent#tag EndEvents#tag Events lstPlugins	#tag Event		Sub CellAction(row As Integer, column As Integer)		  dim plugin as Plugin = me.cellTag(row, 0)		  plugin.enable(me.cellCheck(row, me.columnCount - 1))		  		End Sub	#tag EndEvent	#tag Event		Sub Change()		  if (pTriggerChangeEvents) then		    btnDeletePlugin.enabled = (me.selCount > 0)		  end if		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.heading(0) = kColumnTitleName		  		  me.heading(me.columnCount - 1) = kColumnTitleEnabled		  me.columnType(me.columnCount - 1) = ListBox.TypeCheckBox		  		  me.sortedColumn = 0		  me.columnSortDirection(0) = 1		  		End Sub	#tag EndEvent	#tag Event		Sub DoubleClick()		  Addon(me.cellTag(me.listIndex, 0)).doubleClicked()		End Sub	#tag EndEvent	#tag Event		Function CompareRows(row1 as Integer, row2 as Integer, column as Integer, ByRef result as Integer) As Boolean		  if column = 0 then		    return underscoreSensitiveCompare(me.cell(row1, column), me.cell(row2, column), result)		  else		    return false		  end if		End Function	#tag EndEvent#tag EndEvents#tag Events btnDeletePlugin	#tag Event		Sub Action()		  deletePlugin()		End Sub	#tag EndEvent#tag EndEvents#tag Events chkEnableAllPlugins	#tag Event		Sub Action()		  // pTriggerAction is in the ExtendedCheckBox superclass and enables us to stop the action firing if checkbox is set programmatically		  if (me.pTriggerAction) then		    enableAll(kListPlugins, me.value)		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events cnvMap	#tag Event		Sub Paint(g As Graphics)		  g.drawPicture(worldmap, 0, 0)		  plotPackages(g)		  		End Sub	#tag EndEvent	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  selectNearestPackage(x, y)		  return true		End Function	#tag EndEvent	#tag Event		Sub MouseDrag(X As Integer, Y As Integer)		  selectNearestPackage(x, y)		End Sub	#tag EndEvent#tag EndEvents#tag Events chkEnableAllCustomSceneryPackages	#tag Event		Sub Action()		  // pTriggerAction is in the ExtendedCheckBox superclass and enables us to stop the action firing if checkbox is set programmatically		  if (me.pTriggerAction) then		    enableAll(kListCustomSceneryPackages, me.value)		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events lstAircraft	#tag Event		Sub DoubleClick()		  Addon(me.cellTag(me.listIndex, 0)).doubleClicked()		  me.expanded(me.listindex) = not me.expanded(me.listindex)		End Sub	#tag EndEvent	#tag Event		Sub ExpandRow(row As Integer)		  dim i as Integer		  		  dim addOn as AddOn = me.CellTag(row, 0)		  		  For i = 1 to addOn.pFolderItem.count		    dim folderItem as FolderItem = addOn.pFolderItem.Item(i)		    		    if Aircraft.isValid(folderItem) then		      // It's a valid Aircraft		      dim aircraft as new Aircraft(folderItem.Name, folderItem, true)		      aircraft.populateListBoxEntry(lstAircraft)		    elseif AircraftFolder.isValid(folderItem) then		      // It's a valid AircraftContainer		      dim aircraftFolder as new AircraftFolder(folderItem.Name, folderItem, true)		      aircraftFolder.populateListBoxEntry(lstAircraft)		    else		      // Don't display anything else		    End if		  Next		  		  // If we ever want icons, the following code is a starting point:		  'dim icon as MacIcon		  'icon = new MacIcon(theChild)		  'icon.Size = 16		  'me.RowPicture(me.LastIndex) = icon		  		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.heading(0) = kColumnTitleName		  me.heading(1) = kColumnTitle3dCockpit		  me.heading(2) = kColumnTitleAirfoils		  me.heading(3) = kColumnTitleSounds		  me.heading(4) = kColumnTitleWeapons		  me.heading(5) = kColumnTitlePlugins		  me.heading(6) = kColumnTitleGoodway		  		  me.sortedColumn = 0		  me.columnSortDirection(0) = 1		  		End Sub	#tag EndEvent	#tag Event		Sub Change()		  if (pTriggerChangeEvents) then		    btnDeleteAircraft.enabled = me.listIndex > -1 and me.cellTag(me.listIndex, 0) isa Aircraft		    btnAddAircraft.enabled = me.listIndex > -1 and me.cellTag(me.listIndex, 0) isa AircraftFolder		    refreshAircraftDisplay()		  end if		End Sub	#tag EndEvent	#tag Event		Function CompareRows(row1 as Integer, row2 as Integer, column as Integer, ByRef result as Integer) As Boolean		  if column = 0 then		    return underscoreSensitiveCompare(me.cell(row1, column), me.cell(row2, column), result)		  else		    return false		  end if		End Function	#tag EndEvent#tag EndEvents#tag Events grpAircraftKey	#tag Event		Sub Open()		  #if TargetWin32 or TargetLinux		    me.top = me.top - 5		    me.height = me.height + 5		  #endif		  		End Sub	#tag EndEvent#tag EndEvents#tag Events txtAircraftKey1	#tag Event		Sub Open()		  #if TargetWin32		    me.top = me.top + 5		  #endif		  		End Sub	#tag EndEvent#tag EndEvents#tag Events txtAircraftKey2	#tag Event		Sub Open()		  #if TargetWin32		    me.top = me.top + 5		  #endif		  		End Sub	#tag EndEvent#tag EndEvents#tag Events txtAircraftKey3	#tag Event		Sub Open()		  #if TargetWin32		    me.top = me.top + 5		  #endif		  		End Sub	#tag EndEvent#tag EndEvents#tag Events grpCustomSceneryKey	#tag Event		Sub Open()		  #if TargetWin32 or TargetLinux		    me.top = me.top - 5		    me.height = me.height + 5		  #endif		  		End Sub	#tag EndEvent#tag EndEvents#tag Events txtCustomSceneryKey1	#tag Event		Sub Open()		  #if TargetWin32		    me.top = me.top + 5		  #endif		  		End Sub	#tag EndEvent#tag EndEvents#tag Events txtCustomSceneryKey2	#tag Event		Sub Open()		  #if TargetWin32		    me.top = me.top + 5		  #endif		  		End Sub	#tag EndEvent#tag EndEvents#tag Events txtCustomSceneryKey3	#tag Event		Sub Open()		  #if TargetWin32		    me.top = me.top + 5		  #endif		  		End Sub	#tag EndEvent#tag EndEvents#tag Events btnAddAircraft	#tag Event		Sub Action()		  addAircraft()		  		  // Collapse and expand the row to refresh its contents		  lstAircraft.expanded(lstAircraft.listIndex) = false		  lstAircraft.refresh()		  lstAircraft.expanded(lstAircraft.listIndex) = true		  		End Sub	#tag EndEvent#tag EndEvents#tag Events lstCSLs	#tag Event		Sub CellAction(row As Integer, column As Integer)		  dim csl as CSL = me.cellTag(row, 0)		  csl.enable(me.cellCheck(row, me.columnCount - 1))		  		End Sub	#tag EndEvent	#tag Event		Sub Change()		  if (pTriggerChangeEvents) then		    btnDeleteCSL.enabled = (me.selCount > 0)		  end if		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.heading(0) = kColumnTitleName		  		  me.heading(me.columnCount - 1) = kColumnTitleEnabled		  me.columnType(me.columnCount - 1) = ListBox.TypeCheckBox		  		  me.sortedColumn = 0		  me.columnSortDirection(0) = 1		  		End Sub	#tag EndEvent	#tag Event		Sub DoubleClick()		  Addon(me.cellTag(me.listIndex, 0)).doubleClicked()		End Sub	#tag EndEvent	#tag Event		Function CompareRows(row1 as Integer, row2 as Integer, column as Integer, ByRef result as Integer) As Boolean		  if column = 0 then		    return underscoreSensitiveCompare(me.cell(row1, column), me.cell(row2, column), result)		  else		    return false		  end if		End Function	#tag EndEvent#tag EndEvents#tag Events chkEnableAllCSLs	#tag Event		Sub Action()		  // pTriggerAction is in the ExtendedCheckBox superclass and enables us to stop the action firing if checkbox is set programmatically		  if (me.pTriggerAction) then		    enableAll(kListCSLs, me.value)		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events btnAddCSL	#tag Event		Sub Action()		  addCSL()		  		End Sub	#tag EndEvent#tag EndEvents#tag Events btnDeleteCSL	#tag Event		Sub Action()		  deleteCSL()		End Sub	#tag EndEvent#tag EndEvents#tag Events btnSetXPlaneFolder	#tag Event		Sub Action()		  if (App.getXPlaneFolder(false)) then		    displayXPlaneFolder()		    scanXPlaneFolder()		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events tmrMapRefresh	#tag Event		Sub Action()		  // Do nothing if there is no selected package		  if lstCustomSceneryPackages.listIndex < 0 then return		  		  // Do nothing if we're not on the scenery tab		  if tpnlMain.value <> 0 then return		  		  dim selectedPackage as CustomSceneryPackage = lstCustomSceneryPackages.cellTag(lstCustomSceneryPackages.listIndex, 0)		  selectedPackage.cycleDrawColour()		  selectedPackage.plotOnMap(cnvMap.graphics, CustomSceneryPackage.kPlanetEarth, true)		  		End Sub	#tag EndEvent#tag EndEvents