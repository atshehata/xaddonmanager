#tag ClassProtected Class AirportDataSceneryObjectInherits SceneryObject	#tag Method, Flags = &h0		 Shared Function isAirportData(folderItem as FolderItem) As boolean		  return folderItem.name = "apt.dat"		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub Constructor(folderItem as FolderItem)		  // Calling the overridden superclass constructor.		  Super.Constructor(folderItem)		  		  dim tis as TextInputStream = folderItem.openAsTextFile()		  dim rowFromFile as String		  dim regex as new RegEx		  dim match as RegExMatch		  		  // 'I' / 'A'		  rowFromFile = tis.ReadLine		  		  // Version line		  rowFromFile = tis.ReadLine		  regex.SearchPattern = kRegexAptDatVersionLine		  match = regex.search(rowFromFile)		  if match = nil then return		  dim fileVersion as String = match.subExpressionString(1)		  		  // Search for Airport lines		  regex.SearchPattern = kRegexAptDatAirportLine		  do		    rowFromFile = tis.ReadLine		    match = regex.search(rowFromFile)		    if match = nil then continue		    pAirportNames.append(match.subExpressionString(1))		  loop until tis.EOF		  		  tis.Close		  		  		exception err as RegExException		  MsgBox err.message		End Sub	#tag EndMethod	#tag Property, Flags = &h0		pAirportNames() As String	#tag EndProperty	#tag Constant, Name = kRegexAptDatAirportLine, Type = String, Dynamic = False, Default = \"^\\s*1\\s+[0-9]*\\s+[01]\\s+[01]\\s+(.*)", Scope = Private	#tag EndConstant	#tag Constant, Name = kRegexAptDatVersionLine, Type = String, Dynamic = False, Default = \"^([0-9]*)", Scope = Private	#tag EndConstant	#tag ViewBehavior		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass